#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "Running post-push tasks..."

# Ensure the WEBHOOK_URL environment variable is set from the user's environment
if [ -z "$WEBHOOK_URL" ]; then
  echo "Error: WEBHOOK_URL is not set. Please configure the environment variable in your system settings."
  exit 1
fi

# Get the branch name
BRANCH=$(git rev-parse --abbrev-ref HEAD)

# Send notification using the WEBHOOK_URL from the user's environment
echo "Sending push notification..."
curl -X POST -H 'Content-type: application/json' \
--data "{\"text\":\"New push made by $(logname) on branch $BRANCH!\"}" \
"$WEBHOOK_URL"

echo "Value is $WEBHOOK_URL"

echo "Post-push tasks completed."
